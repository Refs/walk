<!DOCTYPE html>
<html>
<head>
    <title>walk.js example</title>
    <style type="text/css">
        td{
            vertical-align:top;
        }
    </style>

</head>
<body>
    <table width="600">
        <tr>
            <td>Label</td>
            <td>Data</td>
        </tr>
        <tr>
            <td>
                <input id="label" value="person"></input>
            </td>
            <td>
                <textarea id="data" style="width:400px;height:300px;">{"_id":"56a40db84ac6b4a268400d61","index":0,"guid":"f20726c4-16c6-4838-8739-054d7ce39f1d","isActive":false,"balance":"$1,949.72","picture":"http://placehold.it/32x32","age":38,"eyeColor":"green","name":"Deanne Malone","gender":"female","company":"PLUTORQUE","email":"deannemalone@plutorque.com","phone":"+1 (920) 402-3052","address":"978 Kenilworth Place, Munjor, Puerto Rico, 7913","about":"Proident dolor pariatur quis sunt incididunt sunt non cupidatat cupidatat commodo. Anim esse ea est esse eiusmod in ullamco irure enim magna qui pariatur irure est. Et velit sint mollit qui qui dolore nisi.\r\n","registered":"2014-05-30T05:43:04 +04:00","latitude":-0.39746,"longitude":-121.359953,"tags":["voluptate","cillum","magna","adipisicing","veniam","elit","do"],"friends":[{"_id":"56a40db81672afc5d1bd145f","index":0,"guid":"ed8f4ba0-f8c9-4ec1-afcc-c707944cbea2","isActive":true,"balance":"$3,490.80","picture":"http://placehold.it/32x32","age":37,"eyeColor":"brown","name":"Cooper Collins","gender":"male","company":"ANDERSHUN","email":"coopercollins@andershun.com","phone":"+1 (910) 491-2089","address":"946 Provost Street, Kansas, Florida, 1168","about":"Ipsum ipsum aliquip Lorem nulla fugiat deserunt consectetur ex nulla occaecat quis in dolor. Aliquip deserunt sint duis aliqua culpa incididunt sint labore eu magna irure. Amet do Lorem tempor sint minim dolor amet dolor occaecat reprehenderit eu ad nulla velit.\r\n","registered":"2014-09-24T11:07:06 +04:00","latitude":-35.11929,"longitude":-111.779147,"tags":["officia","cupidatat","labore","ipsum","sint","dolor","aliquip"],"friends":[{"id":0,"name":"Peck Burgess"},{"id":1,"name":"Huff Pennington"},{"id":2,"name":"Sexton Sims"},{"id":3,"name":"Ortega Richard"},{"id":4,"name":"Koch Acosta"},{"id":5,"name":"Harrell Serrano"}],"greeting":"Hello, Cooper Collins! You have 7 unread messages.","favoriteFruit":"banana"},{"_id":"56a40db8aac04ebecf025c47","index":1,"guid":"30c6ad5d-b025-492b-b35d-3f96664259c3","isActive":false,"balance":"$3,307.12","picture":"http://placehold.it/32x32","age":33,"eyeColor":"brown","name":"Delia Conley","gender":"female","company":"ZILLIDIUM","email":"deliaconley@zillidium.com","phone":"+1 (821) 445-3056","address":"348 Alabama Avenue, Elizaville, South Dakota, 506","about":"Ea aute fugiat est Lorem mollit mollit velit excepteur ad. Consequat esse elit dolore minim exercitation aliquip. Commodo qui irure sunt laborum deserunt esse elit aute fugiat consequat pariatur reprehenderit dolor irure. Proident Lorem ipsum sint officia et Lorem reprehenderit aute irure. Pariatur laboris ullamco dolor occaecat. Id commodo in veniam labore aute eu sit cupidatat adipisicing est proident ut magna labore. Fugiat officia consectetur cillum incididunt aliqua ad labore.\r\n","registered":"2014-09-02T01:49:50 +04:00","latitude":89.280399,"longitude":-176.835465,"tags":["sit","exercitation","ut","adipisicing","est","ullamco","pariatur"],"friends":[{"id":0,"name":"Mendez Forbes"},{"id":1,"name":"Reyes Black"},{"id":2,"name":"Alvarado Baker"},{"id":3,"name":"Virginia Walker"},{"id":4,"name":"Velma Mercer"},{"id":5,"name":"Haley Morrow"},{"id":6,"name":"Laurie Hogan"},{"id":7,"name":"Charlotte Barber"},{"id":8,"name":"Clara Spencer"},{"id":9,"name":"Boyer Flowers"}],"greeting":"Hello, Delia Conley! You have 9 unread messages.","favoriteFruit":"strawberry"},{"_id":"56a40db8842ac9c679fbb29c","index":2,"guid":"9f524e99-3a37-4e04-9fe6-a8dfa1867048","isActive":true,"balance":"$2,450.83","picture":"http://placehold.it/32x32","age":30,"eyeColor":"blue","name":"Allen Clements","gender":"male","company":"ASIMILINE","email":"allenclements@asimiline.com","phone":"+1 (815) 495-2274","address":"547 Bennet Court, Bladensburg, Ohio, 1284","about":"Nulla qui aliqua et excepteur ipsum sint anim ad veniam. Eiusmod dolor aliqua dolore aliquip duis. Fugiat veniam et aliqua ea ex cillum amet reprehenderit nisi ad. Ea officia ad do consequat voluptate sit et elit deserunt. Tempor elit ut deserunt et Lorem exercitation laborum consectetur laborum. Ut nulla anim occaecat irure tempor aliquip.\r\n","registered":"2014-03-11T05:23:25 +04:00","latitude":66.507677,"longitude":66.054671,"tags":["mollit","incididunt","pariatur"],"friends":[{"id":0,"name":"Isabelle Griffith"},{"id":1,"name":"Schmidt Coleman"},{"id":2,"name":"Edwards Holloway"},{"id":3,"name":"Madden White"},{"id":4,"name":"Nicholson Hinton"},{"id":5,"name":"Flora Wooten"},{"id":6,"name":"Schultz Wise"},{"id":7,"name":"Hunter Ross"},{"id":8,"name":"Georgina Bonner"},{"id":9,"name":"Francesca Castillo"},{"id":10,"name":"Calhoun Huffman"},{"id":11,"name":"Eve Mathews"}],"greeting":"Hello, Allen Clements! You have 7 unread messages.","favoriteFruit":"banana"},{"_id":"56a40db8fabc40b54a2d5ee5","index":3,"guid":"6e13df8c-c64f-4dbd-b125-a1e91d8642e7","isActive":true,"balance":"$3,753.58","picture":"http://placehold.it/32x32","age":39,"eyeColor":"brown","name":"Bridgett Lara","gender":"female","company":"PYRAMIA","email":"bridgettlara@pyramia.com","phone":"+1 (875) 459-3772","address":"225 Mayfair Drive, Kennedyville, New Jersey, 359","about":"Exercitation nostrud nulla magna aliquip ad dolore consectetur in pariatur cillum. Sunt qui labore officia consectetur ullamco irure esse anim incididunt nulla. Consequat deserunt quis amet nisi aliquip in aute nisi eiusmod magna sunt et nostrud aute. Ut duis fugiat consectetur aliquip exercitation veniam tempor nulla.\r\n","registered":"2015-04-13T02:59:55 +04:00","latitude":3.116506,"longitude":-125.204917,"tags":["enim","consectetur","pariatur","culpa"],"friends":[{"id":0,"name":"Jane Walsh"},{"id":1,"name":"Mcdaniel Duran"},{"id":2,"name":"William Cortez"},{"id":3,"name":"Adams Giles"},{"id":4,"name":"Mayo Beach"},{"id":5,"name":"Hinton Stanley"},{"id":6,"name":"Melva Joyce"},{"id":7,"name":"Ramirez Mooney"},{"id":8,"name":"Odonnell Cervantes"},{"id":9,"name":"Snow Gonzalez"},{"id":10,"name":"Noemi Schultz"},{"id":11,"name":"Bird Pate"},{"id":12,"name":"Madelyn Knowles"}],"greeting":"Hello, Bridgett Lara! You have 3 unread messages.","favoriteFruit":"banana"},{"_id":"56a40db81f57166163ccec5b","index":4,"guid":"6dfc4420-2160-4df9-b9fc-c0adc7c5f6c6","isActive":false,"balance":"$2,428.35","picture":"http://placehold.it/32x32","age":26,"eyeColor":"green","name":"Miles Miller","gender":"male","company":"QUONK","email":"milesmiller@quonk.com","phone":"+1 (808) 599-2985","address":"519 Legion Street, Lowgap, Michigan, 598","about":"Consequat labore deserunt occaecat quis. Ut qui reprehenderit eiusmod dolore eiusmod. Ad in voluptate anim nulla dolor ex voluptate eu eiusmod nostrud tempor ut. Minim nostrud consectetur velit quis do veniam reprehenderit consequat ullamco laborum ad cupidatat non. Quis aliqua ipsum ipsum ad aute commodo ullamco do aute qui Lorem consectetur in.\r\n","registered":"2016-01-11T09:27:20 +05:00","latitude":-19.077652,"longitude":-66.502518,"tags":["exercitation","est","commodo"],"friends":[{"id":0,"name":"Henrietta Carter"},{"id":1,"name":"Meredith Munoz"},{"id":2,"name":"Alberta Booker"},{"id":3,"name":"Henry Miranda"},{"id":4,"name":"Augusta Torres"},{"id":5,"name":"Aline Valenzuela"},{"id":6,"name":"Dunn Church"},{"id":7,"name":"Yesenia Schroeder"},{"id":8,"name":"Newton Gibson"},{"id":9,"name":"Lucinda Romero"},{"id":10,"name":"Cindy Cash"},{"id":11,"name":"Roberta Owen"},{"id":12,"name":"Frye Snyder"},{"id":13,"name":"Rodgers Valentine"}],"greeting":"Hello, Miles Miller! You have 9 unread messages.","favoriteFruit":"apple"},{"_id":"56a40db84e099f629669d382","index":5,"guid":"160a849d-7799-45a1-b64f-105360a868db","isActive":false,"balance":"$3,699.44","picture":"http://placehold.it/32x32","age":34,"eyeColor":"blue","name":"Hayden Howell","gender":"male","company":"BEADZZA","email":"haydenhowell@beadzza.com","phone":"+1 (981) 535-2411","address":"840 Times Placez, Gilmore, Marshall Islands, 4679","about":"Dolore veniam voluptate eu consectetur commodo eu. Anim cupidatat incididunt ea ullamco tempor non eiusmod labore sunt. Eiusmod proident enim aliquip commodo mollit. In sint nisi ea velit ad commodo in. Fugiat sint ut sunt irure nisi adipisicing aliqua ex aliqua duis adipisicing officia laboris consequat. Amet reprehenderit et veniam culpa sunt exercitation. Laborum veniam cupidatat sit in officia tempor ipsum irure et incididunt excepteur.\r\n","registered":"2015-02-20T10:13:11 +05:00","latitude":84.289338,"longitude":147.816881,"tags":["nulla","eiusmod","culpa","ea"],"friends":[{"id":0,"name":"Myrtle Ayers"},{"id":1,"name":"Mccoy Sanders"},{"id":2,"name":"Lowery Dale"},{"id":3,"name":"Cathleen Silva"},{"id":4,"name":"Ashley Castro"},{"id":5,"name":"Hanson Olsen"},{"id":6,"name":"Melinda Padilla"},{"id":7,"name":"Williams Ratliff"},{"id":8,"name":"Mueller Mathis"}],"greeting":"Hello, Hayden Howell! You have 1 unread messages.","favoriteFruit":"strawberry"},{"_id":"56a40db80204c5530fb0b088","index":6,"guid":"ab18ab62-530d-49a4-bf0c-79f41922ec57","isActive":true,"balance":"$1,186.85","picture":"http://placehold.it/32x32","age":39,"eyeColor":"green","name":"Conley Slater","gender":"male","company":"SQUISH","email":"conleyslater@squish.com","phone":"+1 (847) 570-2973","address":"666 Nassau Street, Wyoming, Alaska, 6922","about":"Culpa aute ex culpa Lorem aliqua in. Cupidatat deserunt amet pariatur dolore nulla adipisicing sunt enim tempor. Enim labore est elit ad duis magna mollit aute veniam ea non. Do incididunt commodo occaecat mollit commodo est. Ullamco in amet enim reprehenderit pariatur est tempor.\r\n","registered":"2014-07-21T06:37:35 +04:00","latitude":-88.921266,"longitude":150.844272,"tags":["ea","magna","et","do","quis","sint"],"friends":[{"id":0,"name":"Bobbi Dillon"},{"id":1,"name":"Nona Webster"},{"id":2,"name":"Fern Bridges"},{"id":3,"name":"Misty Norton"},{"id":4,"name":"Rodriquez Whitney"},{"id":5,"name":"Vinson Hartman"},{"id":6,"name":"Tami Gallagher"}],"greeting":"Hello, Conley Slater! You have 8 unread messages.","favoriteFruit":"banana"},{"_id":"56a40db8aac0289a4e187eab","index":7,"guid":"6feb6505-3055-47a2-b59a-08aa583fad60","isActive":false,"balance":"$2,927.93","picture":"http://placehold.it/32x32","age":38,"eyeColor":"brown","name":"Natalie Stein","gender":"female","company":"NEXGENE","email":"nataliestein@nexgene.com","phone":"+1 (842) 439-2493","address":"259 Ridgewood Place, Foxworth, Georgia, 1939","about":"Consectetur consectetur ea esse ut mollit nulla sunt ullamco pariatur. Exercitation voluptate sit ut nisi Lorem eu. Commodo et nostrud voluptate cupidatat proident occaecat amet aliquip laborum duis fugiat eiusmod nisi.\r\n","registered":"2015-10-24T10:37:35 +04:00","latitude":25.285205,"longitude":165.352904,"tags":["sunt","proident","nisi","nostrud","culpa"],"friends":[{"id":0,"name":"Bean Lee"},{"id":1,"name":"Mamie Howe"},{"id":2,"name":"Todd Langley"},{"id":3,"name":"Clayton Johnson"},{"id":4,"name":"Kristie Mills"},{"id":5,"name":"Claudia Pratt"},{"id":6,"name":"Audrey Maldonado"},{"id":7,"name":"Bruce English"},{"id":8,"name":"Marina Ward"},{"id":9,"name":"Emma Martinez"},{"id":10,"name":"Lessie Tyler"},{"id":11,"name":"Ochoa Paul"},{"id":12,"name":"Lynne Crosby"}],"greeting":"Hello, Natalie Stein! You have 5 unread messages.","favoriteFruit":"banana"},{"_id":"56a40db8a313e202905324ef","index":8,"guid":"790179b2-3619-4123-b7be-c78f1c85dfa9","isActive":true,"balance":"$2,140.51","picture":"http://placehold.it/32x32","age":29,"eyeColor":"brown","name":"Jessica Nguyen","gender":"female","company":"SNIPS","email":"jessicanguyen@snips.com","phone":"+1 (897) 503-2814","address":"759 Fleet Place, Wildwood, North Dakota, 4612","about":"Anim cupidatat laboris velit occaecat labore. Do esse Lorem nisi minim tempor culpa. Mollit qui fugiat magna adipisicing velit reprehenderit fugiat minim exercitation. Duis reprehenderit aliquip et eiusmod amet pariatur qui.\r\n","registered":"2014-03-02T07:18:03 +05:00","latitude":14.922731,"longitude":81.750239,"tags":["et","non","reprehenderit","occaecat","excepteur"],"friends":[{"id":0,"name":"Heidi Gordon"},{"id":1,"name":"Casandra Bates"},{"id":2,"name":"Karyn Hardin"},{"id":3,"name":"Lilly Marquez"},{"id":4,"name":"Natalia Estrada"},{"id":5,"name":"Rodriguez Peck"},{"id":6,"name":"Vance Sutton"},{"id":7,"name":"Flores Doyle"},{"id":8,"name":"Woods Dickerson"},{"id":9,"name":"Small Mcgee"},{"id":10,"name":"Wilkinson Morgan"}],"greeting":"Hello, Jessica Nguyen! You have 3 unread messages.","favoriteFruit":"apple"},{"_id":"56a40db8f7b4d09e9f0e1417","index":9,"guid":"f9603b63-9292-4bf2-ab78-501296a1abc7","isActive":false,"balance":"$2,863.74","picture":"http://placehold.it/32x32","age":22,"eyeColor":"brown","name":"Velez Cantu","gender":"male","company":"FARMEX","email":"velezcantu@farmex.com","phone":"+1 (907) 416-2012","address":"971 Clark Street, Greenock, Palau, 2227","about":"Eiusmod aute nulla enim magna incididunt esse anim adipisicing. Nulla aliquip tempor laboris sunt aliqua anim laborum dolor. Ea quis adipisicing id aliqua commodo dolore pariatur nulla tempor sunt ea anim. Esse cupidatat cillum dolor et ad reprehenderit ut quis deserunt fugiat labore. Mollit eiusmod nostrud non cillum ea enim eu. Ipsum cupidatat Lorem et elit ullamco commodo laborum aliqua commodo eiusmod. Proident mollit fugiat commodo reprehenderit dolor reprehenderit nisi mollit proident exercitation nisi.\r\n","registered":"2016-01-11T03:50:59 +05:00","latitude":60.647711,"longitude":-141.783535,"tags":["aliqua","incididunt","labore"],"friends":[{"id":0,"name":"Hood Stewart"},{"id":1,"name":"Nikki Shannon"},{"id":2,"name":"Therese Wilkins"},{"id":3,"name":"Wade Harrison"},{"id":4,"name":"Hartman Graham"},{"id":5,"name":"Mcgee Dejesus"},{"id":6,"name":"Zelma Gilliam"},{"id":7,"name":"Ryan Cochran"},{"id":8,"name":"Mclaughlin Livingston"},{"id":9,"name":"Oliver Williams"},{"id":10,"name":"Whitfield Beard"},{"id":11,"name":"Higgins Aguirre"}],"greeting":"Hello, Velez Cantu! You have 7 unread messages.","favoriteFruit":"strawberry"},{"_id":"56a40db87b0f6805b32b0c80","index":10,"guid":"a382c252-ff15-40c2-bed2-4feceb3a4d48","isActive":true,"balance":"$2,067.23","picture":"http://placehold.it/32x32","age":20,"eyeColor":"blue","name":"Grace Spears","gender":"female","company":"ZEAM","email":"gracespears@zeam.com","phone":"+1 (908) 416-2470","address":"266 Newton Street, Connerton, Missouri, 9422","about":"Sint anim in excepteur tempor tempor. Id irure sint dolor officia esse nisi consectetur do anim aliquip nostrud magna reprehenderit dolore. Mollit ea in nisi veniam sit aute tempor aliqua voluptate. Enim occaecat ea deserunt non. Laboris occaecat ex deserunt veniam nisi tempor reprehenderit ea. Officia incididunt deserunt cillum tempor aliquip. Irure pariatur do exercitation cupidatat ullamco est eiusmod amet.\r\n","registered":"2015-07-19T12:42:43 +04:00","latitude":-51.253491,"longitude":-83.855778,"tags":["tempor","anim"],"friends":[{"id":0,"name":"Caldwell Alford"},{"id":1,"name":"Vanessa Avery"},{"id":2,"name":"Rose Conway"},{"id":3,"name":"Barr Watson"},{"id":4,"name":"Ericka Vaughn"},{"id":5,"name":"Viola Prince"},{"id":6,"name":"Velasquez Petersen"},{"id":7,"name":"Jimmie Guzman"},{"id":8,"name":"Leticia Oliver"},{"id":9,"name":"Haley Bush"}],"greeting":"Hello, Grace Spears! You have 4 unread messages.","favoriteFruit":"apple"}],"greeting":"Hello, Deanne Malone! You have 8 unread messages.","favoriteFruit":"apple"}
                </textarea>
            </td>
        </tr>

    </table>
    <br>
    <table>
        <tr>
            <th>Examples</th>
        </tr>
        <tr>
            <td>Print a nested representation of the object</td>
            <td><button onclick="printNested()">Do it!</button></td>
        </tr>
        <tr>
            <td>Get all person objects and count their friends. Then sort them descendingly, and print to console.</td>
            <td><button onclick="getFriendCount()">Do it!</button></td>
        </tr>
        <tr>
            <td>Flatten all unique email properties into an array and print them to console.</td>
            <td><button onclick="flatten()">Do it!</button></td>
        </tr>
    </table>
    <script type="text/javascript">


        function getFriendCount(){
            var data = JSON.parse(document.getElementById('data').innerHTML);
            var friendCounts = {};
            var config = {
                log: false,
                classMap: {
                    "person": "person",
                    "friends": "person"
                },
                callbacks:[
                    {
                        name: 'friend counter',
                        positions: ['postWalk'],
                        classNames: ['person'],
                        //keys: ['friends'],
                        classKeys: {
                            'person': ['friends']
                        },
                        containers: ['array'],
                        callback: function(key, val, className, owner, arrayAssignment, arrayAssignmentKey, isRoot){
                            if (typeof(friendCounts[owner.name]) === 'undefined'){
                                friendCounts[owner.name] = val.length;
                            } else {
                                friendCounts[owner.name] += val.length;
                            }
                        }
                    }
                ]
                
            }
            var className = document.getElementById('label').value;
            walk.walk(data, className, config);
            arr = [];
            for (var key in friendCounts) {
                arr.push([key, friendCounts[key]]);
            }
            arr.sort(function(a, b) {return b[1] - a[1]})
            console.log("Friend-count ranking:")
            for (var i = 0; i < arr.length; ++i ){
                console.log("  ", (i + 1) + ".", arr[i][0], "-", arr[i][1]);
            }
        }

        function printNested(){
            var data = JSON.parse(document.getElementById('data').innerHTML);
            var className = document.getElementById('label').value;
            walk.walk(data, className, {
                log: true,
                classMap: {
                    "person": "person",
                    "friends": "person"
                }
            });
        }

        function flatten(){
            var data = JSON.parse(document.getElementById('data').innerHTML);
            var flattened = walk.flatten(data, 'email', true);
            console.log(flattened);
        }


    </script>
    <script src="walk.js"></script>
</body>
</html>